<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cemetery.domain.mapper.DeceasedInfoMapper">

    <!-- 根据墓位ID查询逝者列表 -->
    <select id="selectByTombId" resultType="com.cemetery.domain.entity.DeceasedInfo">
        SELECT * FROM deceased_info
        WHERE tomb_id = #{tombId} AND deleted = 0
        ORDER BY burial_date DESC
    </select>

    <!-- 根据逝者姓名模糊查询 -->
    <select id="selectByNameLike" resultType="com.cemetery.domain.entity.DeceasedInfo">
        SELECT * FROM deceased_info
        WHERE deceased_name LIKE CONCAT('%', #{name}, '%') AND deleted = 0
        ORDER BY death_date DESC
    </select>

    <!-- 根据身份证号查询 -->
    <select id="selectByIdCard" resultType="com.cemetery.domain.entity.DeceasedInfo">
        SELECT * FROM deceased_info
        WHERE id_card = #{idCard} AND deleted = 0
        LIMIT 1
    </select>

</mapper>
